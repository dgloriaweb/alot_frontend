import{u as m,r as d,c as u,a as t,b as g,i as y,v as h,t as c,j as b,k as _,g as p}from"./index-CZqAe08o.js";import{v as C}from"./api-BB1QELzZ.js";const V={class:"card"},k={class:"form-group"},x=["disabled"],S={key:0,class:"error"},D={__name:"LoginCode",setup(w){const v=_(),o=m(),r=d(o.loginCode),n=d(!1),s=d("");async function f(){var i,e,l;n.value=!0,s.value="";try{o.setLoginCode(r.value);const a=await C(o.email,r.value);o.login(a.user),v.push("/dashboard")}catch(a){((i=a.response)==null?void 0:i.status)===422?s.value="Invalid code. Please check and try again.":(l=(e=a.response)==null?void 0:e.data)!=null&&l.message?s.value=a.response.data.message:s.value="Could not verify code. Please try again."}finally{n.value=!1}}return(i,e)=>(p(),u("section",V,[e[2]||(e[2]=t("h1",null,"Enter login code",-1)),t("form",{onSubmit:b(f,["prevent"])},[t("div",k,[e[1]||(e[1]=t("label",{for:"code"},"One-time code",-1)),y(t("input",{id:"code","onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l),type:"text",pattern:"\\\\d{6}",maxlength:"6",required:"",placeholder:"123456"},null,512),[[h,r.value]])]),t("button",{class:"btn btn-primary",type:"submit",disabled:n.value},c(n.value?"Verifying...":"Verify code"),9,x)],32),s.value?(p(),u("p",S,c(s.value),1)):g("",!0)]))}};export{D as default};
