import{_ as M,u as E,r as c,x as L,o as x,c as r,a as s,d as _,w as g,e as B,t as u,h as v,F as h,f as m,n as w,B as P,k as D,g as n,l as V}from"./index-CZqAe08o.js";import{a as $,d as N}from"./api-BB1QELzZ.js";import{A as U}from"./AdCard-B1YXt8-j.js";const F={class:"page-header"},I={key:0,class:"card"},O={key:1,class:"card"},R={class:"error"},S={key:2,class:"card empty-state"},Y={key:3},z={class:"ads-stats"},j={class:"filter-tabs"},q=["onClick"],G={class:"ads-list"},H={__name:"MyAds",setup(J){const y=D();E();const a=c([]),p=c(!0),d=c(""),i=c("all"),A=["Organiser","Attendant","Venue","Tutor"],k=L(()=>i.value==="all"?a.value:a.value.filter(t=>(t.type||t.user_type||"").toLowerCase()===i.value.toLowerCase()));function C(t){return a.value.filter(e=>(e.type||e.user_type||"").toLowerCase()===t.toLowerCase())}async function f(){var t;p.value=!0,d.value="";try{const e=await $();a.value=e}catch(e){if(window.location.hostname==="localhost"&&window.location.port==="3000"){d.value="Unable to load your ads. Using mock data for localhost.";const{mockMyAds:l}=await P(async()=>{const{mockMyAds:o}=await import("./mockMyAds-fOeE4gT6.js");return{mockMyAds:o}},[]);a.value=l}else((t=e.response)==null?void 0:t.status)===401?(d.value="Please log in to view your ads.",y.push("/login")):d.value="Unable to load your ads. Please try again."}finally{p.value=!1}}function b(t){y.push(`/post-ad?edit=${t.id}&type=${t.type||t.user_type}`)}async function T(t){var e;if(confirm(`Are you sure you want to delete "${t.title||"this ad"}"?`))try{if(window.location.hostname==="localhost"&&window.location.port==="3000"){console.log("Deleting ad:",t.id),a.value=a.value.filter(l=>l.id!==t.id),alert("Ad deleted successfully! (Mock)");return}await N(t.id),alert("Ad deleted successfully!"),f()}catch(l){console.error("Error deleting ad:",l),((e=l.response)==null?void 0:e.status)===401?(alert("Please log in to delete ads."),y.push("/login")):alert("Error deleting ad. Please try again.")}}return x(()=>{f()}),(t,e)=>{const l=B("router-link");return n(),r("section",null,[s("div",F,[e[2]||(e[2]=s("h1",null,"My Ads",-1)),_(l,{to:"/post-ad",class:"btn btn-primary"},{default:g(()=>[...e[1]||(e[1]=[v("+ Create New Ad",-1)])]),_:1})]),p.value?(n(),r("div",I,[...e[3]||(e[3]=[s("p",null,"Loading your ads...",-1)])])):d.value?(n(),r("div",O,[s("p",R,u(d.value),1)])):a.value.length===0?(n(),r("div",S,[e[5]||(e[5]=s("p",null,"You haven't created any ads yet.",-1)),_(l,{to:"/post-ad",class:"btn btn-primary"},{default:g(()=>[...e[4]||(e[4]=[v("Create your first ad",-1)])]),_:1})])):(n(),r("div",Y,[s("div",z,[s("p",null,[e[6]||(e[6]=v("You have ",-1)),s("strong",null,u(a.value.length),1),v(" "+u(a.value.length===1?"ad":"ads"),1)]),s("div",j,[(n(),r(h,null,m(A,o=>s("button",{key:o,class:w(["filter-tab",{active:i.value===o}]),onClick:K=>i.value=o},u(o)+" ("+u(C(o).length)+") ",11,q)),64)),s("button",{class:w(["filter-tab",{active:i.value==="all"}]),onClick:e[0]||(e[0]=o=>i.value="all")}," All ("+u(a.value.length)+") ",3)])]),s("div",G,[(n(!0),r(h,null,m(k.value,o=>(n(),V(U,{key:o.id,ad:o,"show-actions":!0,onEdit:b,onDelete:T},null,8,["ad"]))),128))])]))])}}},Z=M(H,[["__scopeId","data-v-cf2f8cb8"]]);export{Z as default};
